var exampleArray = [
    {
    ascent: 1493,
    conditionStatus: "Minor Issues",
    county: "Pierce County",
    covidStatus: "",
    descent: -1485,
    difficulty: "blueBlack",
    id: 7002140,
    image: "https://cdn2.apstatic.com/photos/hike/7011377_medium_1554559259.jpg",
    latitude: 46.787,
    length: 5.3,
    location: "Eatonville, Washington",
    longitude: -121.735,
    name: "Skyline Trail",
    popularity: "",
    starVotes: 91,
    stars: 4.8,
    state: "Washington",
    summary: "A popular and easily accessible route, skirting the slopes of Mount Rainier and Paradise Glacier.",
    userImg: "https://cdn2.apstatic.com/photos/hike/7011377_medium_1554559259.jpg"
    },
    {
    ascent: 1493,
    conditionStatus: "Minor Issues",
    county: "Pierce County",
    covidStatus: "",
    descent: -1485,
    difficulty: "blueBlack",
    id: 7002140,
    image: "https://cdn2.apstatic.com/photos/hike/7011377_medium_1554559259.jpg",
    latitude: 46.787,
    length: 5.3,
    location: "Eatonville, Washington",
    longitude: -121.735,
    name: "Skyline Trail",
    popularity: "",
    starVotes: 91,
    stars: 4.8,
    state: "Washington",
    summary: "A popular and easily accessible route, skirting the slopes of Mount Rainier and Paradise Glacier.",
    userImg: "https://cdn2.apstatic.com/photos/hike/7011377_medium_1554559259.jpg"
    },
    {
    ascent: 3281,
    conditionStatus: "All Clear",
    county: "King County",
    covidStatus: "",
    descent: -3282,
    difficulty: "blueBlack",
    id: 7001016,
    image: "https://cdn2.apstatic.com/photos/hike/7004228_medium_1554244390.jpg",
    latitude: 47.4882,
    length: 6.6,
    location: "Tanner, Washington",
    longitude: -121.7233,
    popularity: "",
    name: "Mt. Si",
    starVotes: 110,
    stars: 4.4,
    state: "Washington",
    summary: "A steep, well-maintained trail takes you atop Mt. Si with outrageous views of Puget Sound.",
    userImg: "https://cdn2.apstatic.com/photos/hike/7004228_medium_1554244390.jpg"
    },
    {
    ascent: 370,
    conditionStatus: "All Clear",
    county: "King County",
    covidStatus: "",
    descent: -370,
    difficulty: "blue",
    id: 7019080,
    image: "https://cdn2.apstatic.com/photos/hike/7032460_medium_1554933260.jpg",
    latitude: 47.4527,
    length: 2.3,
    location: "Riverbend, Washington",
    longitude: -121.7053,
    name: "Twin Falls",
    popularity: "",
    starVotes: 68,
    stars: 4.3,
    state: "Washington",
    summary: "A classic family-friendly route through old growth trees with a spectacular waterfall in the mix.",
    userImg: "https://cdn2.apstatic.com/photos/hike/7032460_medium_1554933260.jpg"
    },
    {
    ascent: 1619,
    conditionStatus: "All Clear",
    county: "King County",
    covidStatus: "",
    descent: -1618,
    difficulty: "blueBlack",
    id: 7005406,
    image: "https://cdn2.apstatic.com/photos/hike/7004771_medium_1554310760.jpg",
    latitude: 47.4999,
    length: 3.9,
    location: "Issaquah, Washington",
    longitude: -122.0211,
    name: "Poo Poo Point via Chirico Trail",
    popularity: "",
    starVotes: 67,
    stars: 4.4,
    state: "Washington",
    summary: "A great place for a picnic and watching paragliders!",
    userImg: "https://cdn2.apstatic.com/photos/hike/7004771_medium_1554310760.jpg"
    },
    {
    ascent: 3739,
    conditionStatus: "Unknown",
    county: "Clallam County",
    covidStatus: "",
    descent: -3748,
    difficulty: "black",
    id: 7002051,
    image: "https://cdn2.apstatic.com/photos/hike/7001107_medium_1554217677.jpg",
    latitude: 47.9551,
    length: 17.6,
    location: "Forks, Washington",
    longitude: -123.8357,
    name: "High Divide Loop",
    popularity: "",
    starVotes: 51,
    stars: 4.9,
    state: "Washington",
    summary: "This loop is a superlative experience that you'll be eager to repeat.",
    userImg: "https://cdn2.apstatic.com/photos/hike/7001107_medium_1554217677.jpg"
    },
    {
    ascent: 3848,
    conditionStatus: "All Clear",
    county: "King County",
    covidStatus: "",
    descent: -3848,
    difficulty: "black",
    id: 7005408,
    image: "https://cdn2.apstatic.com/photos/hike/7005310_medium_1554311893.jpg",
    latitude: 47.4666,
    length: 9.7,
    location: "Riverbend, Washington",
    longitude: -121.6739,
    name: "Mailbox Peak Trail",
    popularity: "",
    starVotes: 51,
    stars: 4.5,
    state: "Washington",
    summary: "An infamous (easier) hike with a mailbox (maintained by volunteers) at the top!",
    userImg: "https://cdn2.apstatic.com/photos/hike/7005310_medium_1554311893.jpg"
    },
    {
    ascent: 3873,
    conditionStatus: "Minor Issues",
    county: "Skagit County",
    covidStatus: "",
    descent: -3872,
    difficulty: "black",
    id: 7013011,
    image: "https://cdn2.apstatic.com/photos/hike/7023891_medium_1554845849.jpg",
    latitude: 48.4755,
    length: 11.5,
    location: "Stehekin, Washington",
    longitude: -121.075,
    name: "Cascade Pass to Sahale Arm",
    popularity: "",
    starVotes: 34,
    stars: 5,
    state: "Washington",
    summary: "Climb steadily through endless switchbacks to an awe-inspiring pass with impressive peaks & glaciers",
    userImg: "https://cdn2.apstatic.com/photos/hike/7023891_medium_1554845849.jpg"
    },
    {
    ascent: 2419,
    conditionStatus: "All Clear",
    county: "Snohomish County",
    covidStatus: "",
    descent: -2419,
    difficulty: "blue",
    id: 7003986,
    image: "https://cdn2.apstatic.com/photos/hike/7007441_medium_1554322863.jpg",
    latitude: 47.8669,
    length: 11.1,
    location: "Gold Bar, Washington",
    longitude: -121.6779,
    name: "Wallace Falls and Lake",
    popularity: "",
    starVotes: 48,
    stars: 4.2,
    state: "Washington",
    summary: "A popular trail system with trail access to both Wallace Falls and Wallace Lake.",
    userImg: "https://cdn2.apstatic.com/photos/hike/7007441_medium_1554322863.jpg"
    },
    {
    ascent: 1295,
    conditionStatus: "Unknown",
    county: "Pierce County",
    covidStatus: "",
    descent: -1295,
    difficulty: "blueBlack",
    id: 7002181,
    image: "https://cdn2.apstatic.com/photos/hike/7027431_medium_1554916207.jpg",
    latitude: 46.9336,
    length: 5.6,
    location: "Eatonville, Washington",
    longitude: -121.8647,
    name: "Tolmie Peak",
    popularity: "",
    starVotes: 37,
    stars: 4.7,
    state: "Washington",
    summary: "A manageable out-and-back showcasing multiple lakes and panoramic views from atop Tolmie Peak.",
    userImg: "https://cdn2.apstatic.com/photos/hike/7027431_medium_1554916207.jpg"
    }
    ] 
// Google Maps:  Still need to research to find query URL, etc.

// API Key:

var gKey = "AIzaSyDQOySmk8taGDt9pVaSXmNHpO0jjMnQkJ8";

function getCounty(lat, lon) {
  var queryLocation = lat + ", " + lon;
  var url =
    "https://maps.googleapis.com/maps/api/geocode/json?latlng=" +
    queryLocation +
    "&sensor=false&key=" +
    gKey;
  //   console.log(url);
  $.ajax({
    method: "GET",
    url: url,
    complete: function (xhr, statusText) {
      //confirms success
      //   console.log(xhr.status);
    },
    error: function (jqXHR, error, errorThrown) {
      //if error with call
      if (jqXHR.status && jqXHR.status == 400) {
        alert(jqXHR.responseText);
      } else {
        // console.log(xhr.status);
        alert("Something went wrong: " + jqXHR.status);
      }
    },
  }).then(function (response) {
    // console.log(response);
    if (response.error_message) {
      // If API invalid or response is 200 but google throwns error
      //   console.log(response.error_message);
      alert("Something went wrong with your request.");
    }
    if (response.status === "ZERO_RESULTS") {
      alert("Sorry, we could not find your location");
    }
    var components = response.results[0].address_components; //this is an array
    components.forEach((item) => {
      var itemState = "";
      var itemCounty = "";
      var checkItem = item.types[0];
      if (checkItem === "administrative_area_level_1") {
        itemState = item.long_name;
        // console.log(itemState);
      }
      if (checkItem === "administrative_area_level_2") {
        itemCounty = item.long_name;
        itemCounty = itemCounty.replace("County", "").trim();
        // console.log(itemCounty);
      }
      var result = {
        state: itemState,
        county: itemCounty,
      };
      return result;
    });
  });
}

// Test cases
// getCounty(0, 0);
// getCounty(47.487983, -121.723172);


function popularity (trailArray) {
    trailArray.forEach(trail => {
        var voteCount = trail.starVotes;
        var rating = trail.stars;
        var popularity = "";
        if (rating >= 4.5) {
            voteCount += 8;
        } else if (rating > 4) {
            voteCount += 5;
        } else if (rating > 3.5) {
            voteCount += 3;
        } else {
            voteCount -= 3;
        }

        if (voteCount < 10) {
            popularity = 1;
        } else if (voteCount < 21) {
            popularity = 2;
        } else if (voteCount < 46) {
            popularity = 3;
        } else if (voteCount < 70) {
            popularity = 4;
        } else if (voteCount >= 70) {
            popularity = 5
        } else {
            alert("Popularity calculation error")
        }
        trail.popularity = popularity
        
    });
}

popularity(exampleArray)
console.log(exampleArray)